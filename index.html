<!DOCTYPE html>
<html>
<head>
  <title>Smart Streetlight Map</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <!-- Google Maps SDK -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAoySOeWQYbvUvwSkpdeaIMGowzDdQJusg"></script>

  <script>
    // ðŸ”¹ Step 4: Replace below config with your Firebase details
    const firebaseConfig = {
      apiKey: "AIzaSyDLb2pMYxnTfXeF6u4SddwFwHC5fhoDhcY",
      databaseURL: "https://console.firebase.google.com/project/street-light-fault-detection-s/database/street-light-fault-detection-s-default-rtdb/data/~2F"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function initMap() {
      const center = { lat: 19.467960, lng: 72.888108 }; // your location
      const map = new google.maps.Map(document.getElementById("map"), {
        center: center,
        zoom: 15
      });

      const marker = new google.maps.Marker({
        position: center,
        map: map,
        title: "Streetlight Status"
      });

      // ðŸ”¹ Listen to Firebase data
      const ref = db.ref("/streetlight");
      ref.on("value", (snapshot) => {
        const data = snapshot.val();

        const colorIcon =
          data.color === "red"
            ? "http://maps.google.com/mapfiles/ms/icons/red-dot.png"
            : data.color === "green"
            ? "http://maps.google.com/mapfiles/ms/icons/green-dot.png"
            : "http://maps.google.com/mapfiles/ms/icons/grey-dot.png";

        marker.setIcon(colorIcon);
        marker.setPosition({
          lat: parseFloat(data.latitude),
          lng: parseFloat(data.longitude),
        });
      });
    }
  </script>
</head>

<body onload="initMap()">
  <h2 style="text-align:center;">ðŸŒ™ Smart Streetlight Monitoring</h2>
  <div id="map" style="width:100%;height:90vh;"></div>
</body>
</html>
